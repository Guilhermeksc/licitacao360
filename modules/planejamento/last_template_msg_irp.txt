    def dashboard_planejamento(self):
        if self.current_dataframe is not None:
            # Salva o DataFrame em um arquivo CSV temporário
            self.current_dataframe.to_csv(STREAMLIT_CSV, index=False)
            
            if STREAMLIT_CSV.exists():
                # Configura a variável de ambiente para não solicitar email
                os.environ["EMAIL_OPT_OUT"] = "true"
                
                # Abrir o diálogo do Streamlit
                dialog = StreamlitDialog(self)
                dialog.exec()
            else:
                QMessageBox.warning(self, "Aviso", "Erro ao salvar o arquivo CSV.")
        else:
            QMessageBox.warning(self, "Aviso", "Não há dados para salvar.")